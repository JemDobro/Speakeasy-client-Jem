(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(e,t,n){e.exports=n(138)},136:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(81),c=n.n(o),i=n(14),s=n(11),u=n(17),l=n(18),p=n(20),h=n(19),m=n(21),d=n(88),f=n.n(d),b=n(47),g=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_BASE_URL||"http://localhost:8080/api",y=function(e){return e.ok?e:e.headers.has("content-type")&&e.headers.get("content-type").startsWith("application/json")?e.json().then(function(e){return Promise.reject(e)}):Promise.reject({code:e.status,message:e.statusText})},v=function(){try{localStorage.removeItem("authToken")}catch(e){}},E="SET_AUTH_TOKEN",j=function(e){return{type:E,authToken:e}},O="CLEAR_AUTH",k=function(){return{type:O}},w="AUTH_REQUEST",T=function(){return{type:w}},N="AUTH_SUCCESS",S="AUTH_ERROR",U=function(e){return{type:S,error:e}},I=function(e,t){var n,r=f()(e);t(j(e)),t((n=r.user,{type:N,currentUser:n})),function(e){try{localStorage.setItem("authToken",e)}catch(t){}}(e)},C=function(e,t){return function(n){return n(T()),fetch("".concat(g,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then(function(e){return y(e)}).then(function(e){return e.json()}).then(function(e){var t=e.authToken;return I(t,n)}).catch(function(e){var t=401===e.code?"Incorrect username or password":"Unable to login, please try again";return n(U(e)),Promise.reject(new b.a({_error:t}))})}},R=function(){return function(e,t){e(T());var n=t().auth.authToken;return fetch("".concat(g,"/auth/refresh"),{method:"POST",headers:{Authorization:"Bearer ".concat(n)}}).then(function(e){return y(e)}).then(function(e){return e.json()}).then(function(t){var n=t.authToken;return I(n,e)}).catch(function(t){e(U(t)),e(k()),v()})}},P=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"logOut",value:function(){this.props.dispatch(k()),v()}},{key:"render",value:function(){var e,t=this;return this.props.loggedIn&&(e=a.a.createElement("button",{onClick:function(){return t.logOut()}},"Log out")),a.a.createElement("div",{className:"header-bar"},a.a.createElement("h1",null,"Speakeasy"),e)}}]),t}(a.a.Component),A=Object(s.b)(function(e){return{loggedIn:null!==e.auth.currentUser}})(P),_=n(63),D=n(62),x=n(34),F=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){!e.meta.active&&this.props.meta.active&&this.input.focus()}},{key:"render",value:function(){var e,t,n=this;return this.props.meta.touched&&this.props.meta.error&&(e=a.a.createElement("div",{className:"form-error"},this.props.meta.error)),this.props.meta.touched&&this.props.meta.warning&&(t=a.a.createElement("div",{className:"form-warning"},this.props.meta.warning)),a.a.createElement("div",{className:"form-input"},a.a.createElement("label",{htmlFor:this.props.input.name},this.props.label,e,t),a.a.createElement("input",Object.assign({},this.props.input,{id:this.props.input.name,type:this.props.type,ref:function(e){return n.input=e}})))}}]),t}(a.a.Component),L=function(e){return e?void 0:"Required"},H=function(e){return""!==e.trim()?void 0:"Cannot be empty"},q=function(e){return e.trim()===e?void 0:"Cannot start or end with whitespace"},B=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onSubmit",value:function(e){return this.props.dispatch(C(e.username,e.password))}},{key:"render",value:function(){var e,t=this;return this.props.error&&(e=a.a.createElement("div",{className:"form-error","aria-live":"polite"},this.props.error)),a.a.createElement("form",{className:"login-form",onSubmit:this.props.handleSubmit(function(e){return t.onSubmit(e)})},e,a.a.createElement("label",{htmlFor:"username"},"Username"),a.a.createElement(_.a,{component:F,type:"text",name:"username",id:"username",validate:[L,H]}),a.a.createElement("label",{htmlFor:"password"},"Password"),a.a.createElement(_.a,{component:F,type:"password",name:"password",id:"password",validate:[L,H]}),a.a.createElement("button",{disabled:this.props.pristine||this.props.submitting},"Log in"))}}]),t}(a.a.Component),J=Object(D.a)({form:"login",onSubmitFail:function(e,t){return t(Object(x.a)("login","username"))}})(B);var M,W,z=Object(s.b)(function(e){return{loggedIn:null!==e.auth.currentUser}})(function(e){return e.loggedIn?a.a.createElement(i.c,{to:"/dashboard"}):a.a.createElement("div",{className:"home"},a.a.createElement("h2",null,"Deployed  Welcome to Speakeasy...do you know the secret knock?"),a.a.createElement(J,null),a.a.createElement("p",null,"Do you find yourself nodding along with your smart tech friends, coworkers, or worse, your boss, as if you understand the latest tech jargon? All the while, secretly hoping that you won't have to feign choking on your drink if someone asks you a question? Are you yearning to get into the club but can't quite speak the language? Step into Speakeasy, learn the language, up your stats and your status as you keep up to date with all the latest secret knocks that open doors... "),a.a.createElement(i.b,{to:"/register"},"Become one of the club"))}),Q=n(94),V="FETCH_PROTECTED_DATA_SUCCESS",G="FETCH_PROTECTED_DATA_ERROR",K=function(){return function(e,t){var n=t().auth.authToken;return fetch("".concat(g,"/questions"),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}}).then(function(e){return y(e)}).then(function(e){return e.json()}).then(function(t){return e({type:V,data:t})}).catch(function(t){e({type:G,error:t})})}},Y=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){console.log(this.props),this.props.dispatch(K())}},{key:"render",value:function(){return console.log("In render",this.props),this.props.protectedData.length<1?a.a.createElement("div",null,"Loading..."):a.a.createElement("div",{className:"dashboard"},a.a.createElement("h2",null,"Hello ".concat(this.props.firstName,", welcome to the club...")),a.a.createElement("div",{className:"question"},a.a.createElement("p",null,"Question: ".concat(this.props.protectedData[1].question))),a.a.createElement("button",{type:"button",className:"nextButton"},"Next"))}}]),t}(a.a.Component),X=function(e){function t(t){var n=t.authenticating,r=t.loggedIn,o=t.error,c=Object(Q.a)(t,["authenticating","loggedIn","error"]);return n?a.a.createElement("div",null,"Logging in..."):!r||o?a.a.createElement(i.c,{to:"/"}):a.a.createElement(e,c)}var n=e.displayName||e.name||"Component";return t.displayName="RequiresLogin(".concat(n,")"),Object(s.b)(function(e,t){return{authenticating:e.auth.loading,loggedIn:null!==e.auth.currentUser,error:e.auth.error}})(t)}(Object(s.b)(function(e){var t=e.auth.currentUser;return{username:e.auth.currentUser.username,firstName:"".concat(t.firstName),protectedData:e.protectedData.data}})(Y)),Z=n(91),$=(M={min:10,max:72},function(e){return M.min&&e.length<M.min?"Must be at least ".concat(M.min," characters long"):M.max&&e.length>M.max?"Must be at most ".concat(M.max," characters long"):void 0}),ee=(W="password",function(e,t){return W in t&&e.trim()===t[W].trim()?void 0:"Does not match"}),te=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onSubmit",value:function(e){var t=this,n=e.username,r=e.password,a=e.firstName,o=e.lastName,c={username:n,password:r,firstName:a,lastName:o};return this.props.dispatch(function(e){return function(t){return fetch("".concat(g,"/users"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return y(e)}).then(function(e){return e.json()}).catch(function(e){var t=e.reason,n=e.message,r=e.location;if("ValidationError"===t)return Promise.reject(new b.a(Object(Z.a)({},r,n)))})}}(c)).then(function(){return t.props.dispatch(C(n,r))})}},{key:"render",value:function(){var e=this;return a.a.createElement("form",{className:"login-form",onSubmit:this.props.handleSubmit(function(t){return e.onSubmit(t)})},a.a.createElement("label",{htmlFor:"firstName"},"First name"),a.a.createElement(_.a,{component:F,type:"text",name:"firstName",validate:[L,H]}),a.a.createElement("label",{htmlFor:"lastName"},"Last name"),a.a.createElement(_.a,{component:F,type:"text",name:"lastName"}),a.a.createElement("label",{htmlFor:"username"},"Username"),a.a.createElement(_.a,{component:F,type:"text",name:"username",validate:[L,H,q]}),a.a.createElement("label",{htmlFor:"password"},"Password"),a.a.createElement(_.a,{component:F,type:"password",name:"password",validate:[L,$,q]}),a.a.createElement("label",{htmlFor:"passwordConfirm"},"Confirm password"),a.a.createElement(_.a,{component:F,type:"password",name:"passwordConfirm",validate:[L,H,ee]}),a.a.createElement("button",{type:"submit",disabled:this.props.pristine||this.props.submitting},"Register"))}}]),t}(a.a.Component),ne=Object(D.a)({form:"registration",onSubmitFail:function(e,t){return t(Object(x.a)("registration",Object.keys(e)[0]))}})(te);var re=Object(s.b)(function(e){return{loggedIn:null!==e.auth.currentUser}})(function(e){return e.loggedIn?a.a.createElement(i.c,{to:"/dashboard"}):a.a.createElement("div",{className:"home"},a.a.createElement("h2",null,"You're almost in! Register here to become one of the club"),a.a.createElement(ne,null),a.a.createElement(i.b,{to:"/"},"Login"))}),ae=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){!e.loggedIn&&this.props.loggedIn?this.startPeriodicRefresh():e.loggedIn&&!this.props.loggedIn&&this.stopPeriodicRefresh()}},{key:"componentWillUnmount",value:function(){this.stopPeriodicRefresh()}},{key:"startPeriodicRefresh",value:function(){var e=this;this.refreshInterval=setInterval(function(){return e.props.dispatch(R())},36e5)}},{key:"stopPeriodicRefresh",value:function(){this.refreshInterval&&clearInterval(this.refreshInterval)}},{key:"render",value:function(){return a.a.createElement("div",{className:"app"},a.a.createElement(A,null),a.a.createElement(i.d,{exact:!0,path:"/",component:z}),a.a.createElement(i.d,{exact:!0,path:"/dashboard",component:X}),a.a.createElement(i.d,{exact:!0,path:"/register",component:re}))}}]),t}(a.a.Component),oe=Object(i.e)(Object(s.b)(function(e){return{hasAuthToken:null!==e.auth.authToken,loggedIn:null!==e.auth.currentUser}})(ae)),ce=n(9),ie=n(64),se=n(92),ue=n.n(se),le={authToken:null,currentUser:null,loading:!1,error:null};var pe={data:[],error:null};var he=n(93),me=Object(ce.createStore)(Object(ce.combineReducers)({form:ie.a,auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;return t.type===E?Object.assign({},e,{authToken:t.authToken}):t.type===O?Object.assign({},e,{authToken:null,currentUser:null}):t.type===w?Object.assign({},e,{loading:!0,error:null}):t.type===N?Object.assign({},e,{loading:!1,currentUser:t.currentUser}):t.type===S?Object.assign({},e,{loading:!1,error:t.error}):e},protectedData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;return console.log(t),t.type===V?(console.log(t.data),Object.assign({},e,{data:t.data,error:null})):t.type===G?Object.assign({},e,{error:t.error}):e}}),Object(he.composeWithDevTools)(Object(ce.applyMiddleware)(ue.a))),de=localStorage.getItem("authToken");if(de){console.log("there is an auth token");var fe=de;me.dispatch(j(fe)),me.dispatch(R())}var be=me;n(136);c.a.render(a.a.createElement(s.a,{store:be},a.a.createElement(i.a,null,a.a.createElement(oe,null))),document.getElementById("root"))}},[[118,2,1]]]);
//# sourceMappingURL=main.4b1cf334.chunk.js.map